FROM node:18-alpine

WORKDIR /app
COPY package*.json ./
RUN npm install
COPY . .

ARG VITE_BACKEND_HOST
ARG VITE_BACKEND_PORT
ARG VITE_BACKEND_URL
ARG VITE_FRONTEND_HOST
ARG VITE_FRONTEND_PORT
ARG VITE_FRONTEND_URL

ENV VITE_BACKEND_HOST=$VITE_BACKEND_HOST
ENV VITE_BACKEND_PORT=$VITE_BACKEND_PORT
ENV VITE_BACKEND_URL=$VITE_BACKEND_URL
ENV VITE_FRONTEND_HOST=$VITE_FRONTEND_HOST
ENV VITE_FRONTEND_PORT=$VITE_FRONTEND_PORT
ENV VITE_FRONTEND_URL=$VITE_FRONTEND_URL

RUN npm run build

CMD [ "npm", "run", "preview" ]
